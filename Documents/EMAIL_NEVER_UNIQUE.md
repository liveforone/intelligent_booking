# 이메일(아이디)은 유니크로 두지 않는다

## 이메일은 외부에 종속적인 값이다.
* 이전까지 필자는 이메일/아이디를 유니크로 두었다.
* 이렇게 하면 중복 검증도 상당히 편해지고 변경에 대한 로직도 안만들어도 되서 좋았기 때문이다.
* 그러나 이러한 방법은 앞으로 취하지 않기도 했다.
* 이메일은 외부에 종속적인 값이다. 외부에 종속적인 값은 언제 바뀔지, 사라질지 모른다.
* 이러한 값을 unique로 설정한다면 아래에 후술할 unique의 특성때문에 상당히 애먹을지도 모른다.

## UNIQUE의 무서움
* 유니크 컬럼의 무서움을 아는가?
* 만약 유니크 컬럼을 변경하길 원한다면 데이터를 삭제하고 다시 insert 해야할것이다.
* 이런 시나리오를 그려볼 수도 있다. 
* "모든 데이터를 잠깐 가지고 있다가 삭제하고 새로 자동으로 만들어 주면 되지 않을까?"
* 그런데 이러한 시나리오가 나쁜것이 아니라, 문제가 발생할 여지가 있다.
* 대부분의 웹 어플리케이션의 엔티티들은 복잡한 연관관계를 맺고 있다. 이러한 연관관계가 끼게 되면 삭제하고 다시 만드는 과정이
* 불가능한 것은 아니지만 많이 까다로워진다. 기존의 데이터가 누락되는, 혹은 조회가 불가능한 상황이 발생될 수 있기 때문이다. 
* 이해를 돕기위해 아래 설명을 덧붙었다.
```
a테이블과 b테이블이 있고, b테이블은 a테이블과 연관관계를 맺는다.
보통 fk로 id를 가지고 있다. id는 auto increment 사용하거나, uuid를 사용하는데, 일반적으로 auto increment 많이 사용한다.
a테이블이 삭제되고 재 생성되면, id의 값이 바뀌어 있다.
a의 id를 이용해 b테이블을 찾는 경우가 발생한다면 기존의 데이터를 절대 찾을 수 없다.
```

## 이메일/아이디는 보안을 위해서라도 비밀번호처럼 주기적 변경이 중요하다
* 위에서 서술한 이유 뿐만 아니더라도 보안을 위해서 비밀번호 처럼 변경이 가능해야한다.
* 비밀번호만 변경하는 것 보다, 이메일과 비밀 번호 모두 변경하는 것이좋다.
* 어차피 이메일을 fk로 쓰는 사람을 거의 없을 것이다. fk로 쓰는 경우에는 값이 변경될 여지가 있는 값을 사용해서는 안된다는것은 다 알것이라 생각한다.